name: All Tests Summary

on:
  push:
    branches: [ main, master, develop, "**feat**" ]
  pull_request:
    branches: [ main, master, develop ]

jobs:
  # Run all unit test workflows
  unit-errorcode:
    uses: ./.github/workflows/unit_ErrorCode.yml
  
  unit-httpmethod:
    uses: ./.github/workflows/unit_HttpMethod.yml
  
  unit-path:
    uses: ./.github/workflows/unit_Path.yml
  
  unit-port:
    uses: ./.github/workflows/unit_Port.yml
  
  unit-size:
    uses: ./.github/workflows/unit_Size.yml
  
  unit-uri:
    uses: ./.github/workflows/unit_Uri.yml
  
  unit-querystringbuilder:
    uses: ./.github/workflows/unit_QueryStringBuilder.yml
  
  unit-permission:
    uses: ./.github/workflows/unit_Permission.yml
  
  unit-uploadaccess:
    uses: ./.github/workflows/unit_UploadAccess.yml
  
  unit-mocks:
    uses: ./.github/workflows/unit_Mocks.yml
  
  # Summary job that depends on all tests
  test-summary:
    runs-on: ubuntu-latest
    needs: [unit-errorcode, unit-httpmethod, unit-path, unit-port, unit-size, unit-uri, unit-querystringbuilder, unit-permission, unit-uploadaccess, unit-mocks]
    if: always()
    
    steps:
    - name: Download all test results
      uses: actions/download-artifact@v6
      with:
        path: test-results
    
    - name: Generate summary
      run: |
        echo "## ðŸ§ª Test Suite Summary" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### Individual Test Results:" >> $GITHUB_STEP_SUMMARY
        
        if [ -d "test-results/test-results-errorcode" ]; then
          echo "- âœ… ErrorCode tests" >> $GITHUB_STEP_SUMMARY
        else
          echo "- âŒ ErrorCode tests" >> $GITHUB_STEP_SUMMARY
        fi
        
        if [ -d "test-results/test-results-httpmethod" ]; then
          echo "- âœ… HttpMethod tests" >> $GITHUB_STEP_SUMMARY
        else
          echo "- âŒ HttpMethod tests" >> $GITHUB_STEP_SUMMARY
        fi
        
        if [ -d "test-results/test-results-path" ]; then
          echo "- âœ… Path tests" >> $GITHUB_STEP_SUMMARY
        else
          echo "- âŒ Path tests" >> $GITHUB_STEP_SUMMARY
        fi
        
        if [ -d "test-results/test-results-port" ]; then
          echo "- âœ… Port tests" >> $GITHUB_STEP_SUMMARY
        else
          echo "- âŒ Port tests" >> $GITHUB_STEP_SUMMARY
        fi
        
        if [ -d "test-results/test-results-size" ]; then
          echo "- âœ… Size tests" >> $GITHUB_STEP_SUMMARY
        else
          echo "- âŒ Size tests" >> $GITHUB_STEP_SUMMARY
        fi
        
        if [ -d "test-results/test-results-uri" ]; then
          echo "- âœ… Uri tests" >> $GITHUB_STEP_SUMMARY
        else
          echo "- âŒ Uri tests" >> $GITHUB_STEP_SUMMARY
        fi
        
        if [ -d "test-results/test-results-querystringbuilder" ]; then
          echo "- âœ… QueryStringBuilder tests" >> $GITHUB_STEP_SUMMARY
        else
          echo "- âŒ QueryStringBuilder tests" >> $GITHUB_STEP_SUMMARY
        fi
        
        if [ -d "test-results/test-results-permission" ]; then
          echo "- âœ… Permission tests" >> $GITHUB_STEP_SUMMARY
        else
          echo "- âŒ Permission tests" >> $GITHUB_STEP_SUMMARY
        fi
        
        if [ -d "test-results/test-results-uploadaccess" ]; then
          echo "- âœ… UploadAccess tests" >> $GITHUB_STEP_SUMMARY
        else
          echo "- âŒ UploadAccess tests" >> $GITHUB_STEP_SUMMARY
        fi
        
        if [ -d "test-results/test-results-mocks" ]; then
          echo "- âœ… Mock tests" >> $GITHUB_STEP_SUMMARY
        else
          echo "- âŒ Mock tests" >> $GITHUB_STEP_SUMMARY
        fi
